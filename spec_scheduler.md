# 윈도우 작업 스케줄러 프로그램 사양서

## 1. 프로젝트 개요

이 프로젝트는 Windows 작업 스케줄러와 유사한 기능을 제공하는 Python 기반 애플리케이션입니다. 사용자가 실행 파일(.exe)을 등록하고 정해진 일정에 따라 자동으로 실행되도록 스케줄을 설정할 수 있습니다.

## 2. 주요 기능

### 2.1 파일 관리
- .exe 파일 추가 기능
- 등록된 파일 목록 표시
- 등록된 파일 삭제 기능

### 2.2 스케줄 관리
- 실행 주기 설정 (일회성, 매일, 매주, 매월)
- 실행 시간 설정 (시, 분, 초)
- 주간 실행 시 요일 선택 기능
- 월간 실행 시 날짜 선택 기능

### 2.3 실행 관리
- 설정된 스케줄에 따라 exe 파일 자동 실행
- 독립적인 프로세스로 실행 (메인 프로그램과 분리)
- 프로그램 종료 후에도 스케줄 유지

### 2.4 UI 기능
- 직관적인 파일 추가 인터페이스
- 스케줄 설정을 위한 사용자 친화적 인터페이스
- 등록된 작업 목록 표시 (파일명, 경로, 스케줄 정보)
- 작업 활성화/비활성화 토글 기능

## 3. 기술 스택

### 3.1 개발 언어 및 프레임워크
- Python 3.8 이상
- UI 프레임워크: PyQt6 또는 tkinter

### 3.2 주요 라이브러리
- `schedule`: 스케줄링 작업 관리
- `subprocess`: 외부 프로세스 실행
- `json`/`pickle`: 설정 및 스케줄 데이터 저장

## 4. 시스템 아키텍처

### 4.1 주요 모듈
- **UI 모듈**: 사용자 인터페이스 관리
- **스케줄러 모듈**: 작업 스케줄링 및 실행 관리
- **프로세스 모듈**: 독립적인 프로세스 실행 처리
- **저장소 모듈**: 스케줄 및 설정 데이터 관리

### 4.2 데이터 흐름
1. 사용자가 UI를 통해 exe 파일 선택 및 스케줄 설정
2. 설정 데이터는 로컬 저장소에 저장
3. 스케줄러 모듈이 저장된 데이터를 기반으로 작업 스케줄링
4. 지정된 시간에 프로세스 모듈이 독립적으로 작업 실행

## 5. 데이터 모델

### 5.1 작업(Task) 모델
```python
task = {
    "id": str,              # 고유 식별자
    "name": str,            # 작업 이름
    "file_path": str,       # 실행 파일 경로
    "schedule_type": str,   # 실행 주기 (once, daily, weekly, monthly)
    "time": str,            # 실행 시간 (HH:MM:SS)
    "days": list,           # 주간 실행 시 요일 (0-6, 월-일)
    "date": int,            # 월간 실행 시 날짜 (1-31)
    "enabled": bool,        # 활성화 상태
    "last_run": str,        # 마지막 실행 시간
    "next_run": str         # 다음 실행 예정 시간
}
```

## 6. 사용자 인터페이스

### 6.1 메인 화면
- 등록된 작업 목록 테이블 (파일명, 스케줄, 상태)
- 작업 추가, 편집, 삭제 버튼
- 작업 활성화/비활성화 토글

### 6.2 작업 추가/편집 화면
- 파일 선택 버튼 및 경로 표시
- 스케줄 유형 선택 (드롭다운)
- 실행 시간 설정 (시간 선택기)
- 요일/날짜 선택 (해당하는 경우)
- 저장/취소 버튼

## 7. 기술적 고려사항

### 7.1 백그라운드 실행
- 시스템 트레이에서 실행 상태 유지
- Windows 시작 시 자동 실행 옵션

### 7.2 보안
- 실행 파일 경로 검증
- 관리자 권한 필요 작업 처리

### 7.3 오류 처리
- 파일 경로 오류 처리
- 스케줄 충돌 관리
- 실행 실패 로깅 및 알림

## 8. 성능 요구사항
- 최소 시스템 자원 사용
- 다수의 스케줄된 작업 지원 (최소 50개)
- 1초 이내의 스케줄 정확도

## 9. 향후 확장 가능성
- 작업 그룹화 기능
- 작업 실행 로그 기능
- 조건부 실행 (이전 작업 성공 시 등)
- 이메일/푸시 알림 기능
- 작업 실행 결과 모니터링 